{% extends 'base.html' %}
{% block title %}Trabajos de Equipo {{ equipo.codigo }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>Trabajos del Equipo: {{ equipo.codigo }}</h2>
  <a href="{{ url_for('equipos', id_cli=equipo.id_cli) }}" class="btn btn-secondary mb-3">Volver a Equipos</a>
 
  <!-- Listado de trabajos -->
  <div class="mb-4">
    <h4>Trabajos Existentes</h4>
    {% if trabajos %}
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>ID</th>
              <th>Trabajo Realizado</th>
              <th>Fecha</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for trabajo in trabajos %}
            <tr>
              <td>{{ trabajo['id_trabajo'] }}</td>
              <td>{{ trabajo['descripcion'] }}</td>
              <td>{{ trabajo.fecha.strftime('%Y-%m-%d') if trabajo.fecha else '' }}</td>
              <td class="{{ 'text-danger' if trabajo.pendiente == 1 else 'text-success' }}">
                  {{ 'Pendiente' if trabajo.pendiente == 1 else 'Completado' }}
              </td>
              <td>
                <form action="{{ url_for('eliminar_trabajo', id_trabajo=trabajo.id_trabajo, id_equipo=equipo.id_equipo) }}" method="post" class="d-inline delete-form">
                  <button type="button" class="btn btn-danger btn-sm">Eliminar</button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p>No hay trabajos cargados para este equipo.</p>
    {% endif %}
  </div>

  <!-- Formulario para agregar trabajo -->
  <hr style="border: 1px solid black;">   
  <div>
    <h4>Agregar Nuevo Trabajo</h4>
    <form method="POST">
      <div class="mb-3">
        <label for="descripcion" class="form-label">Descripci√≥n del Trabajo</label>
        <textarea id="descripcion" name="descripcion" class="form-control" required></textarea>
      </div>
      <div class="mb-3">
        <label for="fecha" class="form-label">Fecha</label>
        <input type="date" id="fecha" name="fecha" class="form-control" required>
      </div>
      <div class="form-check mb-3">
        <input type="checkbox" id="pendiente" name="pendiente" class="form-check-input">
        <label for="pendiente" class="form-check-label">Pendiente</label>
      </div>
      <button type="submit" class="btn btn-success">Agregar Trabajo</button>
    </form>
  </div>
</div>
{% endblock %}
