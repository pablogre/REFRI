{% extends 'base.html' %}
{% block title %}Equipos de {{ cliente.cliente }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>Equipos del Cliente: {{ cliente.cliente }}</h2>
  <a href="{{ url_for('nuevo_equipo', id_cli=cliente.id_cli) }}" class="btn btn-primary mb-3">Agregar Equipo</a>
  <a href="{{ url_for('index') }}" class="btn btn-secondary mb-3">Volver a Clientes</a>

  <div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Código</th>
          <th>Nro Serie</th>
          <th>Capacidad</th>
          <th>Marca</th>
          <th>Modelo</th>
          <th>Refrigerante</th>
          <th>Altura</th>
          <th>Observaciones</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for equipo in equipos %}
        <tr>
          <td>{{ equipo.id_equipo }}</td>
          <td>{{ equipo.codigo }}</td>
          <td>{{ equipo.nro_serie }}</td>
          <td>{{ equipo.capacidad }}</td>
          <td>{{ equipo.marca }}</td>
          <td>{{ equipo.modelo }}</td>
          <td>{{ equipo.refrigerante }}</td>
          <td>{{ 'Sí' if equipo.altura else 'No' }}</td>
          <td style="max-width: 200px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" title="{{ equipo.obs }}">{{ equipo.obs }}</td>
          <td>
            <a href="{{ url_for('trabajos_equipo', id_equipo=equipo.id_equipo) }}" class="btn btn-info btn-sm mb-1">Ver Trabajos</a>
            <a href="{{ url_for('editar_equipo', id_equipo=equipo.id_equipo) }}" class="btn btn-warning btn-sm mb-1">Editar</a>
            <form action="{{ url_for('eliminar_equipo', id_equipo=equipo.id_equipo, id_cli=cliente.id_cli) }}" method="POST" style="display:inline-block;" onsubmit="return confirm('¿Seguro que querés eliminar este equipo?');">
              <button type="submit" class="btn btn-danger btn-sm mb-1">Eliminar</button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr><td colspan="10" class="text-center">No hay equipos cargados para este cliente.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
